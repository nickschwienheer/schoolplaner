<!DOCTYPE html>
<link rel="stylesheet" href="style.css">
<link rel="manifest" href="manifest.json">
<html lang="en">
<head>
        <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="apple-touch-startup-image" href="icon.png">
        <link rel="apple-touch-icon" href="icon.png">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="initial-scale=1,viewport-fit=cover, user-scalable=no">
<link rel="apple-touch-startup-image" href="splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="splash.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="splash.png" media="(min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="splash.png" media="(min-device-width: 834px) and (max-device-width: 834px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="splash.png" media="(min-device-width: 1024px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">


    
</head>
<header>
<br><br>
<a onclick="menuDropOut()" class="menuButton"><img src="menu.png" height="50px"></a>
<h1>Schulplaner</h1>
</header>

 <body>


         <br><br><br><br><br>
         <br><br><br>
         <div class="überschrift">

                <h2>Stundenplan</h2>
        </div>
         <div style="width: 100%;"></div>
         <table class="tg" style="table-layout: fixed; width: 98%; height: 50vh;">
                        <colgroup>
                        <col style="width: 34px">
                        <col style="width: 63px">
                        <col style="width: 63px">
                        <col style="width: 63px">
                        <col style="width: 63px">
                        <col style="width: 63px">
                        </colgroup>
                          <tr>
                            <th class="tg-6shb"><br></th>
                            <th class="tg-6shb">Mo.</th>
                            <th class="tg-6shb">Di.</th>
                            <th class="tg-6shb">Mi.</th>
                            <th class="tg-6shb">Do.</th>
                            <th class="tg-6shb">Fr.</th>
                          </tr>
                          <tr>
                            <td class="tg-szxb">1.</td>
                            <td id="1" class="tg-ced2"></td>
                            <td id="10" class="tg-s6z2"></td>
                            <td id="19" class="tg-s6z2"></td>
                            <td id="28" class="tg-s6z2"></td>
                            <td id="37" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                            <td class="tg-szxb">2.</td>
                            <td id="2" class="tg-s6z2"></td>
                            <td id="11" class="tg-s6z2"></td>
                            <td id="20" class="tg-s6z2"></td>
                            <td id="29" class="tg-s6z2"></td>
                            <td id="38" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                            <td class="tg-szxb">3.</td>
                            <td id="3" class="tg-s6z2"></td>
                            <td id="12" class="tg-s6z2"></td>
                            <td id="21" class="tg-s6z2"></td>
                            <td id="30" class="tg-s6z2"></td>
                            <td id="39" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                            <td class="tg-szxb">4.</td>
                            <td id="4" class="tg-s6z2"></td>
                            <td id="13" class="tg-s6z2"></td>
                            <td id="22" class="tg-s6z2"></td>
                            <td id="31" class="tg-s6z2"></td>
                            <td id="40" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                            <td class="tg-szxb">5.</td>
                            <td id="5" class="tg-s6z2"></td>
                            <td id="14" class="tg-s6z2"></td>
                            <td id="23" class="tg-s6z2"></td>
                            <td id="32" class="tg-s6z2"></td>
                            <td id="41" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                            <td class="tg-szxb">6.</td>
                            <td id="6" class="tg-s6z2"></td>
                            <td id="15" class="tg-s6z2"></td>
                            <td id="24" class="tg-s6z2"></td>
                            <td id="33" class="tg-s6z2"></td>
                            <td id="42" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                            <td class="tg-szxb">7</td>
                            <td id="7" class="tg-s6z2"></td>
                            <td id="16" class="tg-s6z2"></td>
                            <td id="25" class="tg-s6z2"></td>
                            <td id="34" class="tg-s6z2"></td>
                            <td id="43" class="tg-s6z2"></td>
                          </tr>
                          <tr>
                                <td class="tg-szxb">8</td>
                                <td id="8" class="tg-s6z2"></td>
                                <td id="17" class="tg-s6z2"></td>
                                <td id="26" class="tg-s6z2"></td>
                                <td id="35" class="tg-s6z2"></td>
                                <td id="44"class="tg-s6z2"></td>
                              </tr>
                              <tr>
                                <td class="tg-szxb">9</td>
                                <td id="9" class="tg-s6z2"></td>
                                <td id="18" class="tg-s6z2"></td>
                                <td id="27" class="tg-s6z2"></td>
                                <td id="36" class="tg-s6z2"></td>
                                <td id="45" class="tg-s6z2"></td>
                              </tr>
                        </table>
                </div>
         <br>
         <br><br><br>



<!--------------------------------homework-widget------------------------------------->
<div class="überschrift">

        <h2>Hausaufgaben</h2>
</div>
                <textarea id="homeworkField" onclick="openHomeworkMode()" class="homework-widget" readonly></textarea>
     
        

<br><br>



<!--------------------------------add-homework-field--------------------------------->

<div id="addHomeworkField" class="addHomeworkField">
        <br><br>
        <h1>Hausaufgaben</h1>
        <br>
        <a class="backButton" onclick="backFromHomework()">zurück</a>
        <div class="überschrift">
        </div>
      
 
        <br>
        <br>
        <textarea id="homework" class="addhomeworkTextField" placeholder="Hausaufgaben hier:"></textarea>
        <br><br>
        <button onclick="saveHomework()">speichern</button>
        <br><br><br>
        <div class="überschrift">
             
        <br><br>

</div>
</div>

<!--------------------------------Events-widget----------------------------------------->
        <div class="überschrift">
        <h2>Termine</h2>
        </div>

        <br>
               
        <div id="events" onclick="openEventsMode()" class="events-widget"></div>
      <br>
      <div id="addEventsField" class="addEventsField">
        <br><br>
        <h1>Termine</h1>
        <br>
        <a class="backButton" onclick="backFromHomework()">zurück</a>
        <div class="überschrift">
        </div>
        <br>
        <br>
        <input id="date" class="datepicker" type="date"> 
        <br><br>
        <input id="Event" type="text" placeholder="Termin"> 
        <br><br>
        <button onclick="saveEvent()">Termin eintragen</button>
        <br><br><br>
        
             <div class="events" id="event0" ondblclick="removeItem('event0')"></div>
             <br>
             <div class="events" id="event1"ondblclick="removeItem('event1')"></div>
             <br>
             <div class="events" id="event2"ondblclick="removeItem('event2')"></div>
             <br>
             <div class="events" id="event3"ondblclick="removeItem('event3')"></div>
             <br>
             <div class="events" id="event4"ondblclick="removeItem('event4')"></div>
             <br>
             <div class="events" id="event5"ondblclick="removeItem('event5')"></div>
             <br>
             <div class="events" id="event6"ondblclick="removeItem('event6')"></div>
             <br>
             <div class="events" id="event7"ondblclick="removeItem('event7')"></div>
             <br>
             <div class="events" id="event8"ondblclick="removeItem('event8')"></div>
             <br>
             <div class="events" id="event9"ondblclick="removeItem('event9')"></div>
             <br>
             <div class="events" id="event10"ondblclick="removeItem('event10')"></div>
             <br>
             <div class="events" id="event11"ondblclick="removeItem('event11')"></div>
             <br>
             <div class="events" id="event12"ondblclick="removeItem('event12')"></div>
             <br>
             <div class="events" id="event13"ondblclick="removeItem('event13')"></div>
             <br>
             <div class="events" id="event14"ondblclick="removeItem('event14')"></div>
             <br>
             <div class="events" id="event15"ondblclick="removeItem('event15')"></div>
             <br>
             <div class="events" id="event16"ondblclick="removeItem('event16')"></div>
             <br>
             <div class="events" id="event17"ondblclick="removeItem('event17')"></div>
             <br>
             <div class="events" id="event18"ondblclick="removeItem('event18')"></div>
             <br>
             <div class="events" id="event19"ondblclick="removeItem('event19')"></div>
             <br>
             <div class="events" id="event20"ondblclick="removeItem('event20')"></div>
        <br><br>

</div>




<!----------------------------------menu------------------------------------>
      <div id="menu" class="menu">
                <button onclick="openTimetable()">Stundenplan</button>
                <br>
                <br>
                <button onclick="openUpdateMode()">Softwareupdate</button>
                <br>
                <br>
                <button onclick="openAccountMode()">Account</button>
      </div>
      



      <div id="configuration1" class="configuration1">
              <br><br><br>
              <h1>Login</h1>
              <br><br><br><br>
              <div id="login">
              <input id="key" type="password" placeholder=" Produktschlüssel:">
              <br>
              <p id="fail"> </p>
              <br>
              <button onclick="login()">einloggen</button>
        </div>
              <br>
              <br>
              <br>
              <br>
              <br>
              <p>oder</p>
              <button onclick="buyAccess()">Produktschlüssel kaufen</button> 
              <br>

        <div class="pageControll">
              <img src="circle-filled.png" width="20px">
              <img  src="circle.png" width="20px">
              <img src="circle.png" width="20px">
        </div>


              <br>
      </div>



      <div id="configuration2" class="configuration1">
        <br><br><br>
    
        <h1>Stundenplan</h1>
        <p>Erstelle deinen Stundenplan</p>
        <br>
      <div style="width: 100%;">
        <table class="tg" style="table-layout: fixed; width: 98%; height: 50vh;">
                <colgroup>
                <col style="width: 34px">
                <col style="width: 63px">
                <col style="width: 63px">
                <col style="width: 63px">
                <col style="width: 63px">
                <col style="width: 63px">
                </colgroup>
                <tr>
                        <th class="tg-6shb"><br></th>
                        <th class="tg-6shb">Mo.</th>
                        <th class="tg-6shb">Di.</th>
                        <th class="tg-6shb">Mi.</th>
                        <th class="tg-6shb">Do.</th>
                        <th class="tg-6shb">Fr.</th>
                      </tr>
                  <tr>
                        <td class="tg-szxb">1.</td>
                        <td id="1$" class="tg-ced2" onclick="addSubject('0')"></td>
                        <td id="10$" class="tg-s6z2" onclick="addSubject('9')"></td>
                        <td id="19$" class="tg-s6z2" onclick="addSubject('18')"></td>
                        <td id="28$" class="tg-s6z2" onclick="addSubject('27')"></td>
                        <td id="37$" class="tg-s6z2" onclick="addSubject('36')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">2.</td>
                        <td id="2$" class="tg-s6z2" onclick="addSubject('1')"></td>
                        <td id="11$" class="tg-s6z2" onclick="addSubject('10')"></td>
                        <td id="20$" class="tg-s6z2" onclick="addSubject('19')"></td>
                        <td id="29$" class="tg-s6z2" onclick="addSubject('28')"></td>
                        <td id="38$" class="tg-s6z2" onclick="addSubject('37')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">3.</td>
                        <td id="3$" class="tg-s6z2" onclick="addSubject('2')"></td>
                        <td id="12$" class="tg-s6z2" onclick="addSubject('11')"></td>
                        <td id="21$" class="tg-s6z2" onclick="addSubject('20')"></td>
                        <td id="30$" class="tg-s6z2" onclick="addSubject('29')"></td>
                        <td id="39$" class="tg-s6z2" onclick="addSubject('38')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">4.</td>
                        <td id="4$" class="tg-s6z2" onclick="addSubject('3')"></td>
                        <td id="13$" class="tg-s6z2" onclick="addSubject('12')"></td>
                        <td id="22$" class="tg-s6z2" onclick="addSubject('21')"></td>
                        <td id="31$" class="tg-s6z2" onclick="addSubject('30')"></td>
                        <td id="40$" class="tg-s6z2" onclick="addSubject('39')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">5.</td>
                        <td id="5$" class="tg-s6z2" onclick="addSubject('4')"></td>
                        <td id="14$" class="tg-s6z2" onclick="addSubject('13')"></td>
                        <td id="23$" class="tg-s6z2" onclick="addSubject('22')"></td>
                        <td id="32$" class="tg-s6z2" onclick="addSubject('31')"></td>
                        <td id="41$" class="tg-s6z2" onclick="addSubject('40')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">6.</td>
                        <td id="6$" class="tg-s6z2" onclick="addSubject('5')"></td>
                        <td id="15$" class="tg-s6z2" onclick="addSubject('14')"></td>
                        <td id="24$" class="tg-s6z2" onclick="addSubject('23')"></td>
                        <td id="33$" class="tg-s6z2" onclick="addSubject('32')"></td>
                        <td id="42$" class="tg-s6z2" onclick="addSubject('41')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">7</td>
                        <td id="7$" class="tg-s6z2" onclick="addSubject('6')"></td>
                        <td id="16$" class="tg-s6z2" onclick="addSubject('15')"></td>
                        <td id="25$" class="tg-s6z2" onclick="addSubject('24')"></td>
                        <td id="34$" class="tg-s6z2" onclick="addSubject('33')"></td>
                        <td id="43$" class="tg-s6z2" onclick="addSubject('42')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">8</td>
                        <td id="8$" class="tg-s6z2" onclick="addSubject('7')"></td>
                        <td id="17$" class="tg-s6z2" onclick="addSubject('16')"></td>
                        <td id="26$" class="tg-s6z2" onclick="addSubject('25')"></td>
                        <td id="35$" class="tg-s6z2" onclick="addSubject('34')"></td>
                        <td id="44$" class="tg-s6z2" onclick="addSubject('43')"></td>
                      </tr>
                      <tr>
                        <td class="tg-szxb">9</td>
                        <td id="9$" class="tg-s6z2" onclick="addSubject('8')"></td>
                        <td id="18$" class="tg-s6z2" onclick="addSubject('17')"></td>
                        <td id="27$" class="tg-s6z2" onclick="addSubject('26')"></td>
                        <td id="36$" class="tg-s6z2" onclick="addSubject('35')"></td>
                        <td id="46$" class="tg-s6z2" onclick="addSubject('44')"></td>
                      </tr>
                    </table>
        </div>



        <div id="subjectSelector" class="selectSubject">
                <h2>Fach auswählen</h2>
                <p>wähle das Fach aus</p>
                <select id="subjectSelectorField">
                        <option></option>
                        <option>Mathe</option>
                        <option>Deutsch</option>
                        <option>Englisch</option>
                        <option>Spanisch</option>
                        <option>Sport</option>
                        <option>Französisch</option>
                        <option>Latein</option>
                        <option>Biologie</option>
                        <option>Religion</option>
                        <option>Musik</option>
                        <option>Kunst</option>
                        <option>Erdkunde</option>
                        <option>Informatik</option>
                        <option>Physik</option>
                        <option>Chemie</option>
                        <option>Wirtschaft</option>
                        <option>Politik</option>
                        <option>Frei</option>
                        
                </select>

                <br><br>
                <button onclick="add()">Hinzufügen</button>

        </div>
<br>
<br><br>
        <button onclick="further()">Weiter</button>
        <div class="pageControll">
                <img  src="circle.png" width="20px">
                <img src="circle-filled.png" width="20px">
                <img src="circle.png" width="20px">
          </div>
        <br>
</div>



<div id="configuration3" class="configuration1">
        <br><br><br><br><br><br><br>
        <h1>Alles Bereit</h1>
        <br><br><br><br><br>
       
        <button onclick="finishConfig()">Fertig</button>

  <div class="pageControll">
        <img  src="circle.png" width="20px">
        <img src="circle.png" width="20px">
        <img src="circle-filled.png" width="20px">
  </div>


        <br>
</div>

<!---------------------------------------------------------Softwareupdate--------------------------------------------------------->

<div id="updater" class="softwareupdate">
        <br><br>
<h1>Softwareupdate</h1>

<br><br><br>
<div class="elements">
<h3>Aktuelle Version</h3>
<p>Version 0.0.5</p>
<br>
<h3>Neuste Version</h3>
<iframe class="newestVersion" src="https://nbs-planer-update.netlify.app"></iframe>
<br><br><br>
</div>
<button onclick="sw()">neuste Version laden</button>
<br><br><br><br><br><br>
<button onclick="leaveUpdateMode()">Verlassen</button>
</div>


<div id="splash" class="splashscreen">
        <br><br><br><br><br><br>
        <br><br><br><br><br><br>
        <img src="icon.png" height="30%">
        <br>
        <h1>Schulplaner</h1>
        
</div>

<script>
     /*   if(sessionStorage.hasOwnProperty("splash")){
                document.getElementById("splash").style.display = "none";
        }else{
                document.getElementById("splash").style.display = "block"
                setTimeout(function(){
                document.getElementById("splash").style.display = "none";
                sessionStorage.setItem("splash", true);
                
        },1500)
        }
        */
</script>

<!----------------------------------------------------implemented scripts-------------------------------------------------------->
<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-database.js"></script>
<script src="database.js"></script>
<script src="openpages.js"></script>
<script src="loadResources.js"></script>



 </body>
</html>





<script>


/*
firebase.database().ref("0001").push().set({
        "key" : "0001"
        
        });

*/

/*navigator.serviceWorker.register('sw.js')
            .then(subscription => console.log(subscription))
            .catch(err => console.error('Fehler', err));
*/
    </script>
    

    <script>

onLoad()
function onLoad(){
if(localStorage.hasOwnProperty("key") && localStorage.getItem("setUp") ==  "established"){
        start();
}else{
        setUp();
}

}
count = 0;
function start(){
if(localStorage.hasOwnProperty("event" + count)){
count++
start();
}else{
        if(count <= 20){


localStorage.setItem("event" + count, " ")
count++
start();
}
}
}

function setUp(){
        if(localStorage.hasOwnProperty("setUp")){

        }else{
        localStorage.setItem("setUp", 0);
        }
        let setUp = parseInt(localStorage.getItem("setUp"));


switch(setUp){
        case 0: document.getElementById("configuration1").style.display = "block";
                break;

        case 1: document.getElementById("configuration2").style.display = "block";
                document.getElementById("configuration1").style.display = "none";
                break;

        case 2: document.getElementById("configuration3").style.display = "block";
                document.getElementById("configuration2").style.display = "none";
                break;

       

        }      
}


function login(){
let key = document.getElementById("key").value;
if(key == ""){         
document.getElementById("fail").innerHTML = "Die Felder dürfen nicht leer sein";
}


firebase.database().ref(key).on("child_added", function (snapshot) {
let saved =  snapshot.val().key;
console.log(saved);
localStorage.setItem("loggedIn", true);
localStorage.setItem("key", saved);
sessionStorage.setItem("check", true);
var timetable = ["", "", "", "", "","", "", "", "", "","", "", "", "", "","", "", "", "", "","", "", "", "", "","", "", "", "", "","", "", "", "", "","", "", "", "", "","", "", "", "", "",];
localStorage.setItem("timetable", JSON.stringify(timetable));
localStorage.setItem("setUp", "1");
location.reload();

});

if(sessionStorage.hasOwnProperty("check")){

}else{
document.getElementById("fail").innerHTML = "Dieses Konto existiert möglicherweise nicht oder das Passwort ist falsch";
}
}
function buyAccess(){
window.open("nbs-web.netlify.app/planer.html");
}



function addSubject(sub){
document.getElementById("subjectSelector").style.display = "block";
sessionStorage.setItem("sub", sub);
   

}

function add(){
    var timetable = JSON.parse(localStorage.getItem("timetable"));
    let sub = sessionStorage.getItem("sub");
    let subject = document.getElementById("subjectSelectorField").value;
    timetable[sub] = subject;
    localStorage.setItem("timetable", JSON.stringify(timetable));
    document.getElementById("subjectSelector").style.display = "none";
    let name = parseInt(sub) + 1 + "$"
    document.getElementById(name).innerHTML = subject;

    


}


function further(){
        localStorage.setItem("setUp", "2")
        document.getElementById("configuration3").style.display = "block";
        document.getElementById("configuration2").style.display = "none";
        let count = 1;
setTimeout(function(){
        checkHWExisting();
function checkHWExisting(){
if(localStorage.hasOwnProperty("hw" + count)){
        count ++;
        checkHWExisting();
}else{
if(count <= 20){
localStorage.setItem("hw" + count, " ");
count++
checkHWExisting();
}
}
}
},1000);
}

function finishConfig(){
        localStorage.setItem("setUp", "established");
        document.getElementById("configuration3").style.display = "none";
        start();
        location.reload();
          
        
}


function saveHomework(){
        let homework = document.getElementById("homework").value;
        localStorage.setItem("homework", homework);
        }
       


function saveEvent(){
        let date = document.getElementById("date").value;
        let event = document.getElementById("Event").value;

        let count = 0;
        addingEvent();
        function addingEvent(){
                if(localStorage.getItem("event" + count) != " "){
                        count++
                        addingEvent();
                }else{
                        localStorage.setItem("event" + count, date + "<br>" + event + "<br>" + "<br>");
                        loadEvents();
                }

}
}

function removeItem(item){
        localStorage.setItem(item, " ");
        document.getElementById(item).style.display = "none";
}
    </script>

    <script src="softwareupdate.js"></script>